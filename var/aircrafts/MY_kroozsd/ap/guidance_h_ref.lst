   1              		.syntax unified
   2              		.cpu cortex-m4
   3              		.eabi_attribute 27, 3
   4              		.fpu fpv4-sp-d16
   5              		.eabi_attribute 20, 1
   6              		.eabi_attribute 21, 1
   7              		.eabi_attribute 23, 3
   8              		.eabi_attribute 24, 1
   9              		.eabi_attribute 25, 1
  10              		.eabi_attribute 26, 1
  11              		.eabi_attribute 30, 4
  12              		.eabi_attribute 34, 1
  13              		.eabi_attribute 18, 4
  14              		.thumb
  15              		.file	"guidance_h_ref.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.gh_saturate_ref_accel,"ax",%progbits
  20              		.align	1
  21              		.thumb
  22              		.thumb_func
  24              	gh_saturate_ref_accel:
  25              	.LFB21:
  26              		.file 1 "firmwares/rotorcraft/guidance/guidance_h_ref.c"
   1:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /*
   2:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * Copyright (C) 2008-2013 The Paparazzi Team
   3:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  *
   4:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * This file is part of paparazzi.
   5:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  *
   6:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * paparazzi is free software; you can redistribute it and/or modify
   7:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * it under the terms of the GNU General Public License as published by
   8:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * the Free Software Foundation; either version 2, or (at your option)
   9:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * any later version.
  10:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  *
  11:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * paparazzi is distributed in the hope that it will be useful,
  12:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  13:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  14:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * GNU General Public License for more details.
  15:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  *
  16:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * You should have received a copy of the GNU General Public License
  17:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * along with paparazzi; see the file COPYING.  If not, write to
  18:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * the Free Software Foundation, 59 Temple Place - Suite 330,
  19:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * Boston, MA 02111-1307, USA.
  20:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  */
  21:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  22:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** @file firmwares/rotorcraft/guidance/guidance_h_ref.c
  23:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  *  Reference generation for horizontal guidance.
  24:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  *
  25:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  */
  26:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  27:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #include "firmwares/rotorcraft/guidance/guidance_h_ref.h"
  28:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #include "generated/airframe.h"
  29:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  30:firmwares/rotorcraft/guidance/guidance_h_ref.c **** struct GuidanceHRef gh_ref;
  31:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  32:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static const int32_t gh_max_accel = BFP_OF_REAL(GUIDANCE_H_REF_MAX_ACCEL, GH_ACCEL_REF_FRAC);
  33:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  34:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_MAX_SPEED_REF_FRAC 7
  35:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  36:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** default second order model natural frequency */
  37:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #ifndef GUIDANCE_H_REF_OMEGA
  38:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GUIDANCE_H_REF_OMEGA RadOfDeg(67.)
  39:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #endif
  40:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** default second order model damping */
  41:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #ifndef GUIDANCE_H_REF_ZETA
  42:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GUIDANCE_H_REF_ZETA  0.85
  43:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #endif
  44:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  45:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_ZETA_OMEGA_FRAC 10
  46:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_OMEGA_2_FRAC 7
  47:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  48:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  49:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** first order time constant */
  50:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #ifndef GUIDANCE_H_REF_TAU
  51:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GUIDANCE_H_REF_TAU 0.5
  52:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #endif
  53:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_REF_INV_TAU_FRAC 16
  54:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  55:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static void gh_compute_route_ref(struct Int32Vect2 *ref_vector);
  56:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static void gh_compute_ref_max(struct Int32Vect2 *ref_vector);
  57:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static void gh_compute_ref_max_accel(struct Int32Vect2 *ref_vector);
  58:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static void gh_compute_ref_max_speed(struct Int32Vect2 *ref_vector);
  59:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static void gh_saturate_ref_accel(void);
  60:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static void gh_saturate_ref_speed(void);
  61:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  62:firmwares/rotorcraft/guidance/guidance_h_ref.c **** void gh_ref_init(void)
  63:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
  64:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.omega = GUIDANCE_H_REF_OMEGA;
  65:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.zeta = GUIDANCE_H_REF_ZETA;
  66:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.zeta_omega = BFP_OF_REAL((GUIDANCE_H_REF_ZETA * GUIDANCE_H_REF_OMEGA), GH_ZETA_OMEGA_FRAC)
  67:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.omega_2 = BFP_OF_REAL((GUIDANCE_H_REF_OMEGA * GUIDANCE_H_REF_OMEGA), GH_OMEGA_2_FRAC);
  68:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_set_tau(GUIDANCE_H_REF_TAU);
  69:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_set_max_speed(GUIDANCE_H_REF_MAX_SPEED);
  70:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
  71:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  72:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  73:firmwares/rotorcraft/guidance/guidance_h_ref.c **** float gh_set_max_speed(float max_speed)
  74:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
  75:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* limit to 100m/s as int version would overflow at  2^14 = 128 m/s */
  76:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.max_speed = Min(fabs(max_speed), 100.0f);
  77:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.max_speed_int = BFP_OF_REAL(gh_ref.max_speed, GH_MAX_SPEED_REF_FRAC);
  78:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   return gh_ref.max_speed;
  79:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
  80:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  81:firmwares/rotorcraft/guidance/guidance_h_ref.c **** float gh_set_tau(float tau)
  82:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
  83:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.tau = tau;
  84:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.tau, 0.01f, 2.0f);
  85:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.inv_tau = BFP_OF_REAL((1. / gh_ref.tau), GH_REF_INV_TAU_FRAC);
  86:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   return gh_ref.tau;
  87:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
  88:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  89:firmwares/rotorcraft/guidance/guidance_h_ref.c **** float gh_set_omega(float omega)
  90:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
  91:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.omega = omega;
  92:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.omega, 0.1f, 5.0f);
  93:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.omega_2 = BFP_OF_REAL((gh_ref.omega * gh_ref.omega), GH_OMEGA_2_FRAC);
  94:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.zeta_omega = BFP_OF_REAL((gh_ref.zeta * gh_ref.omega), GH_ZETA_OMEGA_FRAC);
  95:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   return gh_ref.omega;
  96:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
  97:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  98:firmwares/rotorcraft/guidance/guidance_h_ref.c **** float gh_set_zeta(float zeta)
  99:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 100:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.zeta = zeta;
 101:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.zeta, 0.7f, 1.2f);
 102:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.zeta_omega = BFP_OF_REAL((gh_ref.zeta * gh_ref.omega), GH_ZETA_OMEGA_FRAC);
 103:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   return gh_ref.zeta;
 104:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 105:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 106:firmwares/rotorcraft/guidance/guidance_h_ref.c **** void gh_set_ref(struct Int32Vect2 pos, struct Int32Vect2 speed, struct Int32Vect2 accel)
 107:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 108:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   struct Int64Vect2 new_pos;
 109:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.x = ((int64_t)pos.x) << (GH_POS_REF_FRAC - INT32_POS_FRAC);
 110:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.y = ((int64_t)pos.y) << (GH_POS_REF_FRAC - INT32_POS_FRAC);
 111:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.pos = new_pos;
 112:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(gh_ref.speed, speed, (INT32_SPEED_FRAC - GH_SPEED_REF_FRAC));
 113:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(gh_ref.accel, accel, (INT32_ACCEL_FRAC - GH_ACCEL_REF_FRAC));
 114:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 115:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 116:firmwares/rotorcraft/guidance/guidance_h_ref.c **** void gh_update_ref_from_pos_sp(struct Int32Vect2 pos_sp)
 117:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 118:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 119:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 120:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.speed, gh_ref.accel);
 121:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 122:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // compute the "speed part" of accel = -2*zeta*omega*speed -omega^2(pos - pos_sp)
 123:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   struct Int32Vect2 speed;
 124:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed, gh_ref.speed, (GH_SPEED_REF_FRAC - GH_ACCEL_REF_FRAC));
 125:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(speed, speed, -2 * gh_ref.zeta_omega);
 126:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed, speed, GH_ZETA_OMEGA_FRAC);
 127:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // compute pos error in pos_sp resolution
 128:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   struct Int32Vect2 pos_err;
 129:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(pos_err, gh_ref.pos, (GH_POS_REF_FRAC - INT32_POS_FRAC));
 130:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_DIFF(pos_err, pos_err, pos_sp);
 131:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // convert to accel resolution
 132:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(pos_err, pos_err, (INT32_POS_FRAC - GH_ACCEL_REF_FRAC));
 133:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // compute the "pos part" of accel
 134:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   struct Int32Vect2 pos;
 135:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(pos, pos_err, -gh_ref.omega_2);
 136:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(pos, pos, GH_OMEGA_2_FRAC);
 137:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // sum accel
 138:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SUM(gh_ref.accel, speed, pos);
 139:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 140:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Compute max ref accel/speed along route before saturation */
 141:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_compute_ref_max(&pos_err);
 142:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 143:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_saturate_ref_accel();
 144:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_saturate_ref_speed();
 145:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 146:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 147:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 148:firmwares/rotorcraft/guidance/guidance_h_ref.c **** void gh_update_ref_from_speed_sp(struct Int32Vect2 speed_sp)
 149:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 150:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* WARNING: SPEED SATURATION UNTESTED */
 151:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 152:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.speed, gh_ref.accel);
 153:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 154:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // compute speed error
 155:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   struct Int32Vect2 speed_err;
 156:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed_err, speed_sp, (INT32_SPEED_FRAC - GH_SPEED_REF_FRAC));
 157:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_DIFF(speed_err, gh_ref.speed, speed_err);
 158:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // convert to accel resolution
 159:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed_err, speed_err, (GH_SPEED_REF_FRAC - GH_ACCEL_REF_FRAC));
 160:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // compute accel from speed_sp
 161:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(gh_ref.accel, speed_err, -gh_ref.inv_tau);
 162:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(gh_ref.accel, gh_ref.accel, GH_REF_INV_TAU_FRAC);
 163:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 164:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Compute max ref accel/speed along route before saturation */
 165:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_compute_ref_max_speed(&speed_sp);
 166:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_compute_ref_max_accel(&speed_err);
 167:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 168:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_saturate_ref_accel();
 169:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_saturate_ref_speed();
 170:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 171:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 172:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static void gh_compute_route_ref(struct Int32Vect2 *ref_vector)
 173:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 174:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   float f_route_ref = atan2f(-ref_vector->y, -ref_vector->x);
 175:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.route_ref = ANGLE_BFP_OF_REAL(f_route_ref);
 176:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Compute North and East route components */
 177:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   PPRZ_ITRIG_SIN(gh_ref.s_route_ref, gh_ref.route_ref);
 178:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   PPRZ_ITRIG_COS(gh_ref.c_route_ref, gh_ref.route_ref);
 179:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.c_route_ref = abs(gh_ref.c_route_ref);
 180:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.s_route_ref = abs(gh_ref.s_route_ref);
 181:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 182:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 183:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static void gh_compute_ref_max(struct Int32Vect2 *ref_vector)
 184:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 185:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Bound ref to max speed/accel along route reference angle.
 186:firmwares/rotorcraft/guidance/guidance_h_ref.c ****    * If angle can't be computed, simply set both axes to max magnitude/sqrt(2).
 187:firmwares/rotorcraft/guidance/guidance_h_ref.c ****    */
 188:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (ref_vector->x == 0 && ref_vector->y == 0) {
 189:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.x = gh_ref.max_accel.y = gh_max_accel * 0.707;
 190:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.x = gh_ref.max_vel.y = gh_ref.max_speed_int * 0.707;
 191:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   } else {
 192:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_compute_route_ref(ref_vector);
 193:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     /* Compute maximum acceleration*/
 194:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.x = INT_MULT_RSHIFT(gh_max_accel, gh_ref.c_route_ref, INT32_TRIG_FRAC);
 195:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.y = INT_MULT_RSHIFT(gh_max_accel, gh_ref.s_route_ref, INT32_TRIG_FRAC);
 196:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     /* Compute maximum reference x/y velocity from absolute max_speed */
 197:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.x = INT_MULT_RSHIFT(gh_ref.max_speed_int, gh_ref.c_route_ref, INT32_TRIG_FRAC);
 198:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.y = INT_MULT_RSHIFT(gh_ref.max_speed_int, gh_ref.s_route_ref, INT32_TRIG_FRAC);
 199:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 200:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* restore gh_ref.speed range (Q14.17) */
 201:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_LSHIFT(gh_ref.max_vel, gh_ref.max_vel, (GH_SPEED_REF_FRAC - GH_MAX_SPEED_REF_FRAC));
 202:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 203:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 204:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static void gh_compute_ref_max_accel(struct Int32Vect2 *ref_vector)
 205:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 206:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Bound ref to max accel along reference vector.
 207:firmwares/rotorcraft/guidance/guidance_h_ref.c ****    * If angle can't be computed, simply set both axes to max magnitude/sqrt(2).
 208:firmwares/rotorcraft/guidance/guidance_h_ref.c ****    */
 209:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (ref_vector->x == 0 && ref_vector->y == 0) {
 210:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.x = gh_ref.max_accel.y = gh_max_accel * 0.707;
 211:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   } else {
 212:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_compute_route_ref(ref_vector);
 213:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     /* Compute maximum acceleration*/
 214:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.x = INT_MULT_RSHIFT(gh_max_accel, gh_ref.c_route_ref, INT32_TRIG_FRAC);
 215:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.y = INT_MULT_RSHIFT(gh_max_accel, gh_ref.s_route_ref, INT32_TRIG_FRAC);
 216:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 217:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 218:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 219:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static void gh_compute_ref_max_speed(struct Int32Vect2 *ref_vector)
 220:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 221:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Bound ref to max speed along reference vector.
 222:firmwares/rotorcraft/guidance/guidance_h_ref.c ****    * If angle can't be computed, simply set both axes to max magnitude/sqrt(2).
 223:firmwares/rotorcraft/guidance/guidance_h_ref.c ****    */
 224:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (ref_vector->x == 0 && ref_vector->y == 0) {
 225:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.x = gh_ref.max_vel.y = gh_ref.max_speed_int * 0.707;
 226:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   } else {
 227:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_compute_route_ref(ref_vector);
 228:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     /* Compute maximum reference x/y velocity from absolute max_speed */
 229:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.x = INT_MULT_RSHIFT(gh_ref.max_speed_int, gh_ref.c_route_ref, INT32_TRIG_FRAC);
 230:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.y = INT_MULT_RSHIFT(gh_ref.max_speed_int, gh_ref.s_route_ref, INT32_TRIG_FRAC);
 231:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 232:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* restore gh_ref.speed range (Q14.17) */
 233:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_LSHIFT(gh_ref.max_vel, gh_ref.max_vel, (GH_SPEED_REF_FRAC - GH_MAX_SPEED_REF_FRAC));
 234:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 235:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 236:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** saturate reference accelerations */
 237:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static void gh_saturate_ref_accel(void)
 238:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
  27              		.loc 1 238 0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              		@ link register save eliminated.
 239:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Saturate accelerations */
 240:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   BoundAbs(gh_ref.accel.x, gh_ref.max_accel.x);
  32              		.loc 1 240 0
  33 0000 094B     		ldr	r3, .L9
  34 0002 1968     		ldr	r1, [r3]
  35 0004 5A6C     		ldr	r2, [r3, #68]
  36 0006 9142     		cmp	r1, r2
  37 0008 02DC     		bgt	.L6
  38              		.loc 1 240 0 is_stmt 0 discriminator 2
  39 000a 5242     		negs	r2, r2
  40 000c 9142     		cmp	r1, r2
  41 000e 00DA     		bge	.L3
  42              	.L6:
  43              		.loc 1 240 0 discriminator 1
  44 0010 1A60     		str	r2, [r3]
  45              	.L3:
 241:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   BoundAbs(gh_ref.accel.y, gh_ref.max_accel.y);
  46              		.loc 1 241 0 is_stmt 1
  47 0012 5968     		ldr	r1, [r3, #4]
  48 0014 9B6C     		ldr	r3, [r3, #72]
  49 0016 044A     		ldr	r2, .L9
  50 0018 9942     		cmp	r1, r3
  51 001a 02DC     		bgt	.L7
  52              		.loc 1 241 0 is_stmt 0 discriminator 2
  53 001c 5B42     		negs	r3, r3
  54 001e 9942     		cmp	r1, r3
  55 0020 00DA     		bge	.L1
  56              	.L7:
  57              		.loc 1 241 0 discriminator 1
  58 0022 5360     		str	r3, [r2, #4]
  59              	.L1:
  60 0024 7047     		bx	lr
  61              	.L10:
  62 0026 00BF     		.align	2
  63              	.L9:
  64 0028 00000000 		.word	.LANCHOR0
  65              		.cfi_endproc
  66              	.LFE21:
  68              		.section	.text.gh_saturate_ref_speed,"ax",%progbits
  69              		.align	1
  70              		.thumb
  71              		.thumb_func
  73              	gh_saturate_ref_speed:
  74              	.LFB22:
 242:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 243:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 244:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** Saturate ref speed and adjust acceleration accordingly */
 245:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static void gh_saturate_ref_speed(void)
 246:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
  75              		.loc 1 246 0 is_stmt 1
  76              		.cfi_startproc
  77              		@ args = 0, pretend = 0, frame = 0
  78              		@ frame_needed = 0, uses_anonymous_args = 0
  79              		@ link register save eliminated.
 247:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (gh_ref.speed.x < -gh_ref.max_vel.x) {
  80              		.loc 1 247 0
  81 0000 134B     		ldr	r3, .L22
  82 0002 DA6B     		ldr	r2, [r3, #60]
  83 0004 9968     		ldr	r1, [r3, #8]
  84 0006 5042     		negs	r0, r2
  85 0008 8142     		cmp	r1, r0
  86 000a 04DA     		bge	.L12
 248:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.speed.x = -gh_ref.max_vel.x;
 249:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     if (gh_ref.accel.x < 0) {
  87              		.loc 1 249 0
  88 000c 1A68     		ldr	r2, [r3]
 248:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.speed.x = -gh_ref.max_vel.x;
  89              		.loc 1 248 0
  90 000e 9860     		str	r0, [r3, #8]
  91              		.loc 1 249 0
  92 0010 002A     		cmp	r2, #0
  93 0012 08DA     		bge	.L14
  94 0014 05E0     		b	.L20
  95              	.L12:
 250:firmwares/rotorcraft/guidance/guidance_h_ref.c ****       gh_ref.accel.x = 0;
 251:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     }
 252:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   } else if (gh_ref.speed.x > gh_ref.max_vel.x) {
  96              		.loc 1 252 0
  97 0016 9142     		cmp	r1, r2
  98 0018 05DD     		ble	.L14
 253:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.speed.x = gh_ref.max_vel.x;
  99              		.loc 1 253 0
 100 001a 9A60     		str	r2, [r3, #8]
 254:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     if (gh_ref.accel.x > 0) {
 101              		.loc 1 254 0
 102 001c 1A68     		ldr	r2, [r3]
 103 001e 002A     		cmp	r2, #0
 104 0020 01DD     		ble	.L14
 105              	.L20:
 255:firmwares/rotorcraft/guidance/guidance_h_ref.c ****       gh_ref.accel.x = 0;
 106              		.loc 1 255 0
 107 0022 0022     		movs	r2, #0
 108 0024 1A60     		str	r2, [r3]
 109              	.L14:
 256:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     }
 257:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 258:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (gh_ref.speed.y < -gh_ref.max_vel.y) {
 110              		.loc 1 258 0
 111 0026 D968     		ldr	r1, [r3, #12]
 112 0028 1B6C     		ldr	r3, [r3, #64]
 113 002a 094A     		ldr	r2, .L22
 114 002c 5842     		negs	r0, r3
 115 002e 8142     		cmp	r1, r0
 116 0030 04DA     		bge	.L16
 259:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.speed.y = -gh_ref.max_vel.y;
 260:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     if (gh_ref.accel.y < 0) {
 117              		.loc 1 260 0
 118 0032 5368     		ldr	r3, [r2, #4]
 259:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.speed.y = -gh_ref.max_vel.y;
 119              		.loc 1 259 0
 120 0034 D060     		str	r0, [r2, #12]
 121              		.loc 1 260 0
 122 0036 002B     		cmp	r3, #0
 123 0038 08DA     		bge	.L11
 124 003a 05E0     		b	.L21
 125              	.L16:
 261:firmwares/rotorcraft/guidance/guidance_h_ref.c ****       gh_ref.accel.y = 0;
 262:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     }
 263:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   } else if (gh_ref.speed.y > gh_ref.max_vel.y) {
 126              		.loc 1 263 0
 127 003c 9942     		cmp	r1, r3
 128 003e 05DD     		ble	.L11
 264:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.speed.y = gh_ref.max_vel.y;
 129              		.loc 1 264 0
 130 0040 D360     		str	r3, [r2, #12]
 265:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     if (gh_ref.accel.y > 0) {
 131              		.loc 1 265 0
 132 0042 5368     		ldr	r3, [r2, #4]
 133 0044 002B     		cmp	r3, #0
 134 0046 01DD     		ble	.L11
 135              	.L21:
 266:firmwares/rotorcraft/guidance/guidance_h_ref.c ****       gh_ref.accel.y = 0;
 136              		.loc 1 266 0
 137 0048 0023     		movs	r3, #0
 138 004a 5360     		str	r3, [r2, #4]
 139              	.L11:
 140 004c 7047     		bx	lr
 141              	.L23:
 142 004e 00BF     		.align	2
 143              	.L22:
 144 0050 00000000 		.word	.LANCHOR0
 145              		.cfi_endproc
 146              	.LFE22:
 148              		.section	.text.gh_compute_route_ref,"ax",%progbits
 149              		.align	1
 150              		.thumb
 151              		.thumb_func
 153              	gh_compute_route_ref:
 154              	.LFB17:
 173:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 155              		.loc 1 173 0
 156              		.cfi_startproc
 157              		@ args = 0, pretend = 0, frame = 0
 158              		@ frame_needed = 0, uses_anonymous_args = 0
 159              	.LVL0:
 174:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   float f_route_ref = atan2f(-ref_vector->y, -ref_vector->x);
 160              		.loc 1 174 0
 161 0000 4368     		ldr	r3, [r0, #4]
 162 0002 0168     		ldr	r1, [r0]
 163 0004 5B42     		negs	r3, r3
 164 0006 4942     		negs	r1, r1
 165 0008 07EE103A 		fmsr	s14, r3	@ int
 166 000c 07EE901A 		fmsr	s15, r1	@ int
 167 0010 B8EEC77A 		fsitos	s14, s14
 168 0014 F8EEE77A 		fsitos	s15, s15
 173:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 169              		.loc 1 173 0
 170 0018 10B5     		push	{r4, lr}
 171              		.cfi_def_cfa_offset 8
 172              		.cfi_offset 4, -8
 173              		.cfi_offset 14, -4
 174:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   float f_route_ref = atan2f(-ref_vector->y, -ref_vector->x);
 174              		.loc 1 174 0
 175 001a 17EE901A 		fmrs	r1, s15
 176 001e 17EE100A 		fmrs	r0, s14
 177              	.LVL1:
 178 0022 FFF7FEFF 		bl	atan2f
 179              	.LVL2:
 175:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.route_ref = ANGLE_BFP_OF_REAL(f_route_ref);
 180              		.loc 1 175 0
 181 0026 DFED0E7A 		flds	s15, .L25
 182 002a 0E4C     		ldr	r4, .L25+4
 183 002c 07EE100A 		fmsr	s14, r0
 184 0030 67EE277A 		fmuls	s15, s14, s15
 185 0034 FDEEE77A 		ftosizs	s15, s15
 186 0038 17EE900A 		fmrs	r0, s15	@ int
 187              	.LVL3:
 188 003c C4ED147A 		fsts	s15, [r4, #80]	@ int
 177:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   PPRZ_ITRIG_SIN(gh_ref.s_route_ref, gh_ref.route_ref);
 189              		.loc 1 177 0
 190 0040 FFF7FEFF 		bl	pprz_itrig_sin
 191              	.LVL4:
 192 0044 6065     		str	r0, [r4, #84]
 178:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   PPRZ_ITRIG_COS(gh_ref.c_route_ref, gh_ref.route_ref);
 193              		.loc 1 178 0
 194 0046 206D     		ldr	r0, [r4, #80]
 195 0048 FFF7FEFF 		bl	pprz_itrig_cos
 196              	.LVL5:
 180:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.s_route_ref = abs(gh_ref.s_route_ref);
 197              		.loc 1 180 0
 198 004c 636D     		ldr	r3, [r4, #84]
 179:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.c_route_ref = abs(gh_ref.c_route_ref);
 199              		.loc 1 179 0
 200 004e 0028     		cmp	r0, #0
 201 0050 B8BF     		it	lt
 202 0052 4042     		rsblt	r0, r0, #0
 180:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.s_route_ref = abs(gh_ref.s_route_ref);
 203              		.loc 1 180 0
 204 0054 002B     		cmp	r3, #0
 205 0056 B8BF     		it	lt
 206 0058 5B42     		rsblt	r3, r3, #0
 179:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.c_route_ref = abs(gh_ref.c_route_ref);
 207              		.loc 1 179 0
 208 005a A065     		str	r0, [r4, #88]
 180:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.s_route_ref = abs(gh_ref.s_route_ref);
 209              		.loc 1 180 0
 210 005c 6365     		str	r3, [r4, #84]
 211 005e 10BD     		pop	{r4, pc}
 212              	.L26:
 213              		.align	2
 214              	.L25:
 215 0060 00008045 		.word	1166016512
 216 0064 00000000 		.word	.LANCHOR0
 217              		.cfi_endproc
 218              	.LFE17:
 220              		.section	.text.gh_ref_init,"ax",%progbits
 221              		.align	1
 222              		.global	gh_ref_init
 223              		.thumb
 224              		.thumb_func
 226              	gh_ref_init:
 227              	.LFB9:
  63:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 228              		.loc 1 63 0
 229              		.cfi_startproc
 230              		@ args = 0, pretend = 0, frame = 0
 231              		@ frame_needed = 0, uses_anonymous_args = 0
 232              		@ link register save eliminated.
  64:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.omega = GUIDANCE_H_REF_OMEGA;
 233              		.loc 1 64 0
 234 0000 0B4B     		ldr	r3, .L28
 235 0002 0C4A     		ldr	r2, .L28+4
 236 0004 5A62     		str	r2, [r3, #36]	@ float
  65:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.zeta = GUIDANCE_H_REF_ZETA;
 237              		.loc 1 65 0
 238 0006 0C4A     		ldr	r2, .L28+8
 239 0008 9A62     		str	r2, [r3, #40]	@ float
  66:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.zeta_omega = BFP_OF_REAL((GUIDANCE_H_REF_ZETA * GUIDANCE_H_REF_OMEGA), GH_ZETA_OMEGA_FRAC)
 240              		.loc 1 66 0
 241 000a 40F2F932 		movw	r2, #1017
 242 000e 1A63     		str	r2, [r3, #48]
  67:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.omega_2 = BFP_OF_REAL((GUIDANCE_H_REF_OMEGA * GUIDANCE_H_REF_OMEGA), GH_OMEGA_2_FRAC);
 243              		.loc 1 67 0
 244 0010 AF22     		movs	r2, #175
 245 0012 5A63     		str	r2, [r3, #52]
 246              	.LVL6:
 247              	.LBB6:
 248              	.LBB7:
  83:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.tau = tau;
 249              		.loc 1 83 0
 250 0014 4FF07C52 		mov	r2, #1056964608
 251 0018 1A62     		str	r2, [r3, #32]	@ float
  85:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.inv_tau = BFP_OF_REAL((1. / gh_ref.tau), GH_REF_INV_TAU_FRAC);
 252              		.loc 1 85 0
 253 001a 4FF40032 		mov	r2, #131072
 254 001e 9A63     		str	r2, [r3, #56]
 255              	.LVL7:
 256              	.LBE7:
 257              	.LBE6:
 258              	.LBB8:
 259              	.LBB9:
  76:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.max_speed = Min(fabs(max_speed), 100.0f);
 260              		.loc 1 76 0
 261 0020 4FF08042 		mov	r2, #1073741824
 262 0024 DA62     		str	r2, [r3, #44]	@ float
  77:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.max_speed_int = BFP_OF_REAL(gh_ref.max_speed, GH_MAX_SPEED_REF_FRAC);
 263              		.loc 1 77 0
 264 0026 4FF48072 		mov	r2, #256
 265 002a DA64     		str	r2, [r3, #76]
 266 002c 7047     		bx	lr
 267              	.L29:
 268 002e 00BF     		.align	2
 269              	.L28:
 270 0030 00000000 		.word	.LANCHOR0
 271 0034 F0AD953F 		.word	1066774000
 272 0038 9A99593F 		.word	1062836634
 273              	.LBE9:
 274              	.LBE8:
 275              		.cfi_endproc
 276              	.LFE9:
 278              		.section	.text.gh_set_max_speed,"ax",%progbits
 279              		.align	1
 280              		.global	gh_set_max_speed
 281              		.thumb
 282              		.thumb_func
 284              	gh_set_max_speed:
 285              	.LFB10:
  74:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 286              		.loc 1 74 0
 287              		.cfi_startproc
 288              		@ args = 0, pretend = 0, frame = 0
 289              		@ frame_needed = 0, uses_anonymous_args = 0
 290              		@ link register save eliminated.
 291              	.LVL8:
  76:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.max_speed = Min(fabs(max_speed), 100.0f);
 292              		.loc 1 76 0
 293 0000 07EE900A 		fmsr	s15, r0
 294 0004 B0EEE77A 		fabss	s14, s15
 295 0008 DFED0B7A 		flds	s15, .L33
 296 000c 0B4B     		ldr	r3, .L33+4
 297 000e B4EEE77A 		fcmpes	s14, s15
 298 0012 F1EE10FA 		fmstat
 299 0016 48BF     		it	mi
 300 0018 F0EE477A 		fcpysmi	s15, s14
  77:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.max_speed_int = BFP_OF_REAL(gh_ref.max_speed, GH_MAX_SPEED_REF_FRAC);
 301              		.loc 1 77 0
 302 001c 9FED087A 		flds	s14, .L33+8
  76:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.max_speed = Min(fabs(max_speed), 100.0f);
 303              		.loc 1 76 0
 304 0020 C3ED0B7A 		fsts	s15, [r3, #44]
  77:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.max_speed_int = BFP_OF_REAL(gh_ref.max_speed, GH_MAX_SPEED_REF_FRAC);
 305              		.loc 1 77 0
 306 0024 27EE877A 		fmuls	s14, s15, s14
  79:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 307              		.loc 1 79 0
 308 0028 17EE900A 		fmrs	r0, s15
 309              	.LVL9:
  77:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.max_speed_int = BFP_OF_REAL(gh_ref.max_speed, GH_MAX_SPEED_REF_FRAC);
 310              		.loc 1 77 0
 311 002c BDEEC77A 		ftosizs	s14, s14
 312 0030 83ED137A 		fsts	s14, [r3, #76]	@ int
  79:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 313              		.loc 1 79 0
 314 0034 7047     		bx	lr
 315              	.L34:
 316 0036 00BF     		.align	2
 317              	.L33:
 318 0038 0000C842 		.word	1120403456
 319 003c 00000000 		.word	.LANCHOR0
 320 0040 00000043 		.word	1124073472
 321              		.cfi_endproc
 322              	.LFE10:
 324              		.global	__aeabi_f2d
 325              		.global	__aeabi_ddiv
 326              		.global	__aeabi_dmul
 327              		.global	__aeabi_d2iz
 328              		.section	.text.gh_set_tau,"ax",%progbits
 329              		.align	1
 330              		.global	gh_set_tau
 331              		.thumb
 332              		.thumb_func
 334              	gh_set_tau:
 335              	.LFB11:
  82:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 336              		.loc 1 82 0
 337              		.cfi_startproc
 338              		@ args = 0, pretend = 0, frame = 0
 339              		@ frame_needed = 0, uses_anonymous_args = 0
 340              	.LVL10:
 341 0000 07EE900A 		fmsr	s15, r0
  84:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.tau, 0.01f, 2.0f);
 342              		.loc 1 84 0
 343 0004 B0EE007A 		fconsts	s14, #0
 344 0008 F4EEC77A 		fcmpes	s15, s14
 345 000c F1EE10FA 		fmstat
  82:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 346              		.loc 1 82 0
 347 0010 38B5     		push	{r3, r4, r5, lr}
 348              		.cfi_def_cfa_offset 16
 349              		.cfi_offset 3, -16
 350              		.cfi_offset 4, -12
 351              		.cfi_offset 5, -8
 352              		.cfi_offset 14, -4
 353 0012 114C     		ldr	r4, .L42
  84:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.tau, 0.01f, 2.0f);
 354              		.loc 1 84 0
 355 0014 02DD     		ble	.L41
  84:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.tau, 0.01f, 2.0f);
 356              		.loc 1 84 0 is_stmt 0 discriminator 1
 357 0016 84ED087A 		fsts	s14, [r4, #32]
 358 001a 0AE0     		b	.L38
 359              	.L41:
  84:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.tau, 0.01f, 2.0f);
 360              		.loc 1 84 0 discriminator 2
 361 001c 9FED0F7A 		flds	s14, .L42+4
 362 0020 F4EEC77A 		fcmpes	s15, s14
 363 0024 F1EE10FA 		fmstat
  83:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.tau = tau;
 364              		.loc 1 83 0 is_stmt 1 discriminator 2
 365 0028 48BF     		it	mi
 366 002a F0EE477A 		fcpysmi	s15, s14
 367 002e C4ED087A 		fsts	s15, [r4, #32]
 368              	.L38:
  85:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.inv_tau = BFP_OF_REAL((1. / gh_ref.tau), GH_REF_INV_TAU_FRAC);
 369              		.loc 1 85 0
 370 0032 256A     		ldr	r5, [r4, #32]	@ float
 371 0034 2846     		mov	r0, r5	@ float
 372              	.LVL11:
 373 0036 FFF7FEFF 		bl	__aeabi_f2d
 374              	.LVL12:
 375 003a 0246     		mov	r2, r0
 376 003c 0B46     		mov	r3, r1
 377 003e 0020     		movs	r0, #0
 378 0040 0749     		ldr	r1, .L42+8
 379 0042 FFF7FEFF 		bl	__aeabi_ddiv
 380              	.LVL13:
 381 0046 0022     		movs	r2, #0
 382 0048 064B     		ldr	r3, .L42+12
 383 004a FFF7FEFF 		bl	__aeabi_dmul
 384              	.LVL14:
 385 004e FFF7FEFF 		bl	__aeabi_d2iz
 386              	.LVL15:
 387 0052 A063     		str	r0, [r4, #56]
  87:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 388              		.loc 1 87 0
 389 0054 2846     		mov	r0, r5	@ float
 390 0056 38BD     		pop	{r3, r4, r5, pc}
 391              	.L43:
 392              		.align	2
 393              	.L42:
 394 0058 00000000 		.word	.LANCHOR0
 395 005c 0AD7233C 		.word	1008981770
 396 0060 0000F03F 		.word	1072693248
 397 0064 0000F040 		.word	1089470464
 398              		.cfi_endproc
 399              	.LFE11:
 401              		.section	.text.gh_set_omega,"ax",%progbits
 402              		.align	1
 403              		.global	gh_set_omega
 404              		.thumb
 405              		.thumb_func
 407              	gh_set_omega:
 408              	.LFB12:
  90:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 409              		.loc 1 90 0
 410              		.cfi_startproc
 411              		@ args = 0, pretend = 0, frame = 0
 412              		@ frame_needed = 0, uses_anonymous_args = 0
 413              		@ link register save eliminated.
 414              	.LVL16:
  90:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 415              		.loc 1 90 0
 416 0000 07EE900A 		fmsr	s15, r0
  92:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.omega, 0.1f, 5.0f);
 417              		.loc 1 92 0
 418 0004 B1EE047A 		fconsts	s14, #20
 419 0008 F4EEC77A 		fcmpes	s15, s14
 420 000c F1EE10FA 		fmstat
 421 0010 154B     		ldr	r3, .L51
 422 0012 02DD     		ble	.L50
  92:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.omega, 0.1f, 5.0f);
 423              		.loc 1 92 0 is_stmt 0 discriminator 1
 424 0014 83ED097A 		fsts	s14, [r3, #36]
 425 0018 0AE0     		b	.L47
 426              	.L50:
  92:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.omega, 0.1f, 5.0f);
 427              		.loc 1 92 0 discriminator 2
 428 001a 9FED147A 		flds	s14, .L51+4
 429 001e F4EEC77A 		fcmpes	s15, s14
 430 0022 F1EE10FA 		fmstat
  91:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.omega = omega;
 431              		.loc 1 91 0 is_stmt 1 discriminator 2
 432 0026 48BF     		it	mi
 433 0028 F0EE477A 		fcpysmi	s15, s14
 434 002c C3ED097A 		fsts	s15, [r3, #36]
 435              	.L47:
  93:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.omega_2 = BFP_OF_REAL((gh_ref.omega * gh_ref.omega), GH_OMEGA_2_FRAC);
 436              		.loc 1 93 0
 437 0030 D3ED097A 		flds	s15, [r3, #36]
 438 0034 9FED0E7A 		flds	s14, .L51+8
 439 0038 67EEA76A 		fmuls	s13, s15, s15
  96:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 440              		.loc 1 96 0
 441 003c 17EE900A 		fmrs	r0, s15
 442              	.LVL17:
  93:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.omega_2 = BFP_OF_REAL((gh_ref.omega * gh_ref.omega), GH_OMEGA_2_FRAC);
 443              		.loc 1 93 0
 444 0040 26EE877A 		fmuls	s14, s13, s14
  94:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.zeta_omega = BFP_OF_REAL((gh_ref.zeta * gh_ref.omega), GH_ZETA_OMEGA_FRAC);
 445              		.loc 1 94 0
 446 0044 DFED0B6A 		flds	s13, .L51+12
  93:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.omega_2 = BFP_OF_REAL((gh_ref.omega * gh_ref.omega), GH_OMEGA_2_FRAC);
 447              		.loc 1 93 0
 448 0048 BDEEC77A 		ftosizs	s14, s14
 449 004c 83ED0D7A 		fsts	s14, [r3, #52]	@ int
  94:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.zeta_omega = BFP_OF_REAL((gh_ref.zeta * gh_ref.omega), GH_ZETA_OMEGA_FRAC);
 450              		.loc 1 94 0
 451 0050 93ED0A7A 		flds	s14, [r3, #40]
 452 0054 27EE877A 		fmuls	s14, s15, s14
 453 0058 27EE267A 		fmuls	s14, s14, s13
 454 005c BDEEC77A 		ftosizs	s14, s14
 455 0060 83ED0C7A 		fsts	s14, [r3, #48]	@ int
  96:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 456              		.loc 1 96 0
 457 0064 7047     		bx	lr
 458              	.L52:
 459 0066 00BF     		.align	2
 460              	.L51:
 461 0068 00000000 		.word	.LANCHOR0
 462 006c CDCCCC3D 		.word	1036831949
 463 0070 00000043 		.word	1124073472
 464 0074 00008044 		.word	1149239296
 465              		.cfi_endproc
 466              	.LFE12:
 468              		.section	.text.gh_set_zeta,"ax",%progbits
 469              		.align	1
 470              		.global	gh_set_zeta
 471              		.thumb
 472              		.thumb_func
 474              	gh_set_zeta:
 475              	.LFB13:
  99:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 476              		.loc 1 99 0
 477              		.cfi_startproc
 478              		@ args = 0, pretend = 0, frame = 0
 479              		@ frame_needed = 0, uses_anonymous_args = 0
 480              		@ link register save eliminated.
 481              	.LVL18:
  99:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 482              		.loc 1 99 0
 483 0000 07EE900A 		fmsr	s15, r0
 101:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.zeta, 0.7f, 1.2f);
 484              		.loc 1 101 0
 485 0004 9FED137A 		flds	s14, .L60
 486 0008 134B     		ldr	r3, .L60+4
 487 000a F4EEC77A 		fcmpes	s15, s14
 488 000e F1EE10FA 		fmstat
 489 0012 02DD     		ble	.L59
 101:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.zeta, 0.7f, 1.2f);
 490              		.loc 1 101 0 is_stmt 0 discriminator 1
 491 0014 83ED0A7A 		fsts	s14, [r3, #40]
 492 0018 0AE0     		b	.L56
 493              	.L59:
 101:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   Bound(gh_ref.zeta, 0.7f, 1.2f);
 494              		.loc 1 101 0 discriminator 2
 495 001a 9FED107A 		flds	s14, .L60+8
 496 001e F4EEC77A 		fcmpes	s15, s14
 497 0022 F1EE10FA 		fmstat
 100:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.zeta = zeta;
 498              		.loc 1 100 0 is_stmt 1 discriminator 2
 499 0026 48BF     		it	mi
 500 0028 F0EE477A 		fcpysmi	s15, s14
 501 002c C3ED0A7A 		fsts	s15, [r3, #40]
 502              	.L56:
 102:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.zeta_omega = BFP_OF_REAL((gh_ref.zeta * gh_ref.omega), GH_ZETA_OMEGA_FRAC);
 503              		.loc 1 102 0
 504 0030 D3ED0A7A 		flds	s15, [r3, #40]
 505 0034 93ED097A 		flds	s14, [r3, #36]
 506 0038 DFED096A 		flds	s13, .L60+12
 507 003c 27EE877A 		fmuls	s14, s15, s14
 104:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 508              		.loc 1 104 0
 509 0040 17EE900A 		fmrs	r0, s15
 510              	.LVL19:
 102:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.zeta_omega = BFP_OF_REAL((gh_ref.zeta * gh_ref.omega), GH_ZETA_OMEGA_FRAC);
 511              		.loc 1 102 0
 512 0044 27EE267A 		fmuls	s14, s14, s13
 513 0048 BDEEC77A 		ftosizs	s14, s14
 514 004c 83ED0C7A 		fsts	s14, [r3, #48]	@ int
 104:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 515              		.loc 1 104 0
 516 0050 7047     		bx	lr
 517              	.L61:
 518 0052 00BF     		.align	2
 519              	.L60:
 520 0054 9A99993F 		.word	1067030938
 521 0058 00000000 		.word	.LANCHOR0
 522 005c 3333333F 		.word	1060320051
 523 0060 00008044 		.word	1149239296
 524              		.cfi_endproc
 525              	.LFE13:
 527              		.section	.text.gh_set_ref,"ax",%progbits
 528              		.align	1
 529              		.global	gh_set_ref
 530              		.thumb
 531              		.thumb_func
 533              	gh_set_ref:
 534              	.LFB14:
 107:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 535              		.loc 1 107 0
 536              		.cfi_startproc
 537              		@ args = 8, pretend = 0, frame = 16
 538              		@ frame_needed = 0, uses_anonymous_args = 0
 539 0000 30B5     		push	{r4, r5, lr}
 540              		.cfi_def_cfa_offset 12
 541              		.cfi_offset 4, -12
 542              		.cfi_offset 5, -8
 543              		.cfi_offset 14, -4
 544 0002 85B0     		sub	sp, sp, #20
 545              		.cfi_def_cfa_offset 32
 546              	.LVL20:
 107:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 547              		.loc 1 107 0
 548 0004 04AC     		add	r4, sp, #16
 549 0006 04E90300 		stmdb	r4, {r0, r1}
 550              	.LVL21:
 110:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.y = ((int64_t)pos.y) << (GH_POS_REF_FRAC - INT32_POS_FRAC);
 551              		.loc 1 110 0
 552 000a 039C     		ldr	r4, [sp, #12]
 109:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.x = ((int64_t)pos.x) << (GH_POS_REF_FRAC - INT32_POS_FRAC);
 553              		.loc 1 109 0
 554 000c 029D     		ldr	r5, [sp, #8]
 110:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.y = ((int64_t)pos.y) << (GH_POS_REF_FRAC - INT32_POS_FRAC);
 555              		.loc 1 110 0
 556 000e E117     		asrs	r1, r4, #31
 107:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 557              		.loc 1 107 0
 558 0010 8DE80C00 		stmia	sp, {r2, r3}
 110:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.y = ((int64_t)pos.y) << (GH_POS_REF_FRAC - INT32_POS_FRAC);
 559              		.loc 1 110 0
 560 0014 8B04     		lsls	r3, r1, #18
 561 0016 43EA9433 		orr	r3, r3, r4, lsr #14
 562 001a A204     		lsls	r2, r4, #18
 563              	.LVL22:
 111:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_ref.pos = new_pos;
 564              		.loc 1 111 0
 565 001c 0B4C     		ldr	r4, .L63
 566 001e C4E90623 		strd	r2, [r4, #24]
 112:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(gh_ref.speed, speed, (INT32_SPEED_FRAC - GH_SPEED_REF_FRAC));
 567              		.loc 1 112 0
 568 0022 009B     		ldr	r3, [sp]
 569 0024 9B10     		asrs	r3, r3, #2
 570 0026 A360     		str	r3, [r4, #8]
 571 0028 019B     		ldr	r3, [sp, #4]
 572 002a 9B10     		asrs	r3, r3, #2
 573 002c E360     		str	r3, [r4, #12]
 113:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(gh_ref.accel, accel, (INT32_ACCEL_FRAC - GH_ACCEL_REF_FRAC));
 574              		.loc 1 113 0
 575 002e 089B     		ldr	r3, [sp, #32]
 576 0030 9B10     		asrs	r3, r3, #2
 109:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.x = ((int64_t)pos.x) << (GH_POS_REF_FRAC - INT32_POS_FRAC);
 577              		.loc 1 109 0
 578 0032 E917     		asrs	r1, r5, #31
 113:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(gh_ref.accel, accel, (INT32_ACCEL_FRAC - GH_ACCEL_REF_FRAC));
 579              		.loc 1 113 0
 580 0034 2360     		str	r3, [r4]
 581 0036 099B     		ldr	r3, [sp, #36]
 109:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.x = ((int64_t)pos.x) << (GH_POS_REF_FRAC - INT32_POS_FRAC);
 582              		.loc 1 109 0
 583 0038 8904     		lsls	r1, r1, #18
 584 003a 41EA9531 		orr	r1, r1, r5, lsr #14
 113:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(gh_ref.accel, accel, (INT32_ACCEL_FRAC - GH_ACCEL_REF_FRAC));
 585              		.loc 1 113 0
 586 003e 9B10     		asrs	r3, r3, #2
 109:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.x = ((int64_t)pos.x) << (GH_POS_REF_FRAC - INT32_POS_FRAC);
 587              		.loc 1 109 0
 588 0040 AD04     		lsls	r5, r5, #18
 589 0042 6161     		str	r1, [r4, #20]
 590 0044 2561     		str	r5, [r4, #16]
 113:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(gh_ref.accel, accel, (INT32_ACCEL_FRAC - GH_ACCEL_REF_FRAC));
 591              		.loc 1 113 0
 592 0046 6360     		str	r3, [r4, #4]
 114:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 593              		.loc 1 114 0
 594 0048 05B0     		add	sp, sp, #20
 595              		@ sp needed
 596 004a 30BD     		pop	{r4, r5, pc}
 597              	.L64:
 598              		.align	2
 599              	.L63:
 600 004c 00000000 		.word	.LANCHOR0
 601              		.cfi_endproc
 602              	.LFE14:
 604              		.global	__aeabi_i2d
 605              		.section	.text.gh_update_ref_from_pos_sp,"ax",%progbits
 606              		.align	1
 607              		.global	gh_update_ref_from_pos_sp
 608              		.thumb
 609              		.thumb_func
 611              	gh_update_ref_from_pos_sp:
 612              	.LFB15:
 117:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 613              		.loc 1 117 0
 614              		.cfi_startproc
 615              		@ args = 0, pretend = 0, frame = 16
 616              		@ frame_needed = 0, uses_anonymous_args = 0
 617 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 618              		.cfi_def_cfa_offset 20
 619              		.cfi_offset 4, -20
 620              		.cfi_offset 5, -16
 621              		.cfi_offset 6, -12
 622              		.cfi_offset 7, -8
 623              		.cfi_offset 14, -4
 119:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 624              		.loc 1 119 0
 625 0002 3F4E     		ldr	r6, .L68+8
 117:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 626              		.loc 1 117 0
 627 0004 85B0     		sub	sp, sp, #20
 628              		.cfi_def_cfa_offset 40
 119:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 629              		.loc 1 119 0
 630 0006 D6E90445 		ldrd	r4, [r6, #16]
 631 000a B268     		ldr	r2, [r6, #8]
 120:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.speed, gh_ref.accel);
 632              		.loc 1 120 0
 633 000c 3768     		ldr	r7, [r6]
 119:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 634              		.loc 1 119 0
 635 000e F368     		ldr	r3, [r6, #12]
 117:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 636              		.loc 1 117 0
 637 0010 8DE80300 		stmia	sp, {r0, r1}
 119:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 638              		.loc 1 119 0
 639 0014 D6E90601 		ldrd	r0, [r6, #24]
 640 0018 A418     		adds	r4, r4, r2
 120:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.speed, gh_ref.accel);
 641              		.loc 1 120 0
 642 001a 02EB070C 		add	ip, r2, r7
 643 001e 7768     		ldr	r7, [r6, #4]
 644 0020 C6F808C0 		str	ip, [r6, #8]
 119:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 645              		.loc 1 119 0
 646 0024 45EBE275 		adc	r5, r5, r2, asr #31
 647 0028 C018     		adds	r0, r0, r3
 129:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(pos_err, gh_ref.pos, (GH_POS_REF_FRAC - INT32_POS_FRAC));
 648              		.loc 1 129 0
 649 002a 4FEA9442 		lsr	r2, r4, #18
 119:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 650              		.loc 1 119 0
 651 002e 41EBE371 		adc	r1, r1, r3, asr #31
 120:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.speed, gh_ref.accel);
 652              		.loc 1 120 0
 653 0032 03EB070E 		add	lr, r3, r7
 129:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(pos_err, gh_ref.pos, (GH_POS_REF_FRAC - INT32_POS_FRAC));
 654              		.loc 1 129 0
 655 0036 42EA8532 		orr	r2, r2, r5, lsl #14
 119:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 656              		.loc 1 119 0
 657 003a C6E90445 		strd	r4, [r6, #16]
 125:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(speed, speed, -2 * gh_ref.zeta_omega);
 658              		.loc 1 125 0
 659 003e 336B     		ldr	r3, [r6, #48]
 130:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_DIFF(pos_err, pos_err, pos_sp);
 660              		.loc 1 130 0
 661 0040 009D     		ldr	r5, [sp]
 120:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.speed, gh_ref.accel);
 662              		.loc 1 120 0
 663 0042 C6F80CE0 		str	lr, [r6, #12]
 664              	.LVL23:
 125:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(speed, speed, -2 * gh_ref.zeta_omega);
 665              		.loc 1 125 0
 666 0046 6FF00107 		mvn	r7, #1
 667 004a 5F43     		muls	r7, r3, r7
 668              	.LVL24:
 130:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_DIFF(pos_err, pos_err, pos_sp);
 669              		.loc 1 130 0
 670 004c 551B     		subs	r5, r2, r5
 671 004e 019B     		ldr	r3, [sp, #4]
 672 0050 0295     		str	r5, [sp, #8]
 129:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(pos_err, gh_ref.pos, (GH_POS_REF_FRAC - INT32_POS_FRAC));
 673              		.loc 1 129 0
 674 0052 820C     		lsrs	r2, r0, #18
 675 0054 42EA8132 		orr	r2, r2, r1, lsl #14
 130:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_DIFF(pos_err, pos_err, pos_sp);
 676              		.loc 1 130 0
 677 0058 D31A     		subs	r3, r2, r3
 135:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(pos, pos_err, -gh_ref.omega_2);
 678              		.loc 1 135 0
 679 005a 726B     		ldr	r2, [r6, #52]
 130:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_DIFF(pos_err, pos_err, pos_sp);
 680              		.loc 1 130 0
 681 005c 0393     		str	r3, [sp, #12]
 135:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(pos, pos_err, -gh_ref.omega_2);
 682              		.loc 1 135 0
 683 005e 5242     		negs	r2, r2
 684              	.LVL25:
 119:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 685              		.loc 1 119 0
 686 0060 C6E90601 		strd	r0, [r6, #24]
 124:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed, gh_ref.speed, (GH_SPEED_REF_FRAC - GH_ACCEL_REF_FRAC));
 687              		.loc 1 124 0
 688 0064 4FEA6E2E 		asr	lr, lr, #9
 689              	.LVL26:
 135:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(pos, pos_err, -gh_ref.omega_2);
 690              		.loc 1 135 0
 691 0068 02FB05F0 		mul	r0, r2, r5
 124:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed, gh_ref.speed, (GH_SPEED_REF_FRAC - GH_ACCEL_REF_FRAC));
 692              		.loc 1 124 0
 693 006c 4FEA6C21 		asr	r1, ip, #9
 135:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(pos, pos_err, -gh_ref.omega_2);
 694              		.loc 1 135 0
 695 0070 5A43     		muls	r2, r3, r2
 696              	.LVL27:
 125:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(speed, speed, -2 * gh_ref.zeta_omega);
 697              		.loc 1 125 0
 698 0072 7943     		muls	r1, r7, r1
 136:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(pos, pos, GH_OMEGA_2_FRAC);
 699              		.loc 1 136 0
 700 0074 C011     		asrs	r0, r0, #7
 701              	.LVL28:
 125:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(speed, speed, -2 * gh_ref.zeta_omega);
 702              		.loc 1 125 0
 703 0076 07FB0EF7 		mul	r7, r7, lr
 704              	.LVL29:
 136:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(pos, pos, GH_OMEGA_2_FRAC);
 705              		.loc 1 136 0
 706 007a D211     		asrs	r2, r2, #7
 707              	.LVL30:
 138:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SUM(gh_ref.accel, speed, pos);
 708              		.loc 1 138 0
 709 007c 00EBA121 		add	r1, r0, r1, asr #10
 710 0080 02EBA727 		add	r7, r2, r7, asr #10
 711 0084 3160     		str	r1, [r6]
 712 0086 7760     		str	r7, [r6, #4]
 713              	.LVL31:
 714 0088 3446     		mov	r4, r6
 715              	.LBB12:
 716              	.LBB13:
 188:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (ref_vector->x == 0 && ref_vector->y == 0) {
 717              		.loc 1 188 0
 718 008a 8DB9     		cbnz	r5, .L66
 719 008c 83B9     		cbnz	r3, .L66
 189:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.x = gh_ref.max_accel.y = gh_max_accel * 0.707;
 720              		.loc 1 189 0
 721 008e 40F2F243 		movw	r3, #1266
 190:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.x = gh_ref.max_vel.y = gh_ref.max_speed_int * 0.707;
 722              		.loc 1 190 0
 723 0092 F06C     		ldr	r0, [r6, #76]
 724              	.LVL32:
 189:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.x = gh_ref.max_accel.y = gh_max_accel * 0.707;
 725              		.loc 1 189 0
 726 0094 B364     		str	r3, [r6, #72]
 727 0096 7364     		str	r3, [r6, #68]
 190:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.x = gh_ref.max_vel.y = gh_ref.max_speed_int * 0.707;
 728              		.loc 1 190 0
 729 0098 FFF7FEFF 		bl	__aeabi_i2d
 730              	.LVL33:
 731 009c 16A3     		adr	r3, .L68
 732 009e D3E90023 		ldrd	r2, [r3]
 733 00a2 FFF7FEFF 		bl	__aeabi_dmul
 734              	.LVL34:
 735 00a6 FFF7FEFF 		bl	__aeabi_d2iz
 736              	.LVL35:
 737 00aa 3064     		str	r0, [r6, #64]
 738 00ac F063     		str	r0, [r6, #60]
 739 00ae 14E0     		b	.L67
 740              	.LVL36:
 741              	.L66:
 192:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_compute_route_ref(ref_vector);
 742              		.loc 1 192 0
 743 00b0 02A8     		add	r0, sp, #8
 744              	.LVL37:
 745 00b2 FFF7FEFF 		bl	gh_compute_route_ref
 746              	.LVL38:
 194:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.x = INT_MULT_RSHIFT(gh_max_accel, gh_ref.c_route_ref, INT32_TRIG_FRAC);
 747              		.loc 1 194 0
 748 00b6 A16D     		ldr	r1, [r4, #88]
 749 00b8 4FF4E063 		mov	r3, #1792
 750 00bc 03FB01F2 		mul	r2, r3, r1
 751 00c0 9213     		asrs	r2, r2, #14
 752 00c2 6264     		str	r2, [r4, #68]
 195:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.y = INT_MULT_RSHIFT(gh_max_accel, gh_ref.s_route_ref, INT32_TRIG_FRAC);
 753              		.loc 1 195 0
 754 00c4 626D     		ldr	r2, [r4, #84]
 755 00c6 5343     		muls	r3, r2, r3
 756 00c8 9B13     		asrs	r3, r3, #14
 757 00ca A364     		str	r3, [r4, #72]
 197:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.x = INT_MULT_RSHIFT(gh_ref.max_speed_int, gh_ref.c_route_ref, INT32_TRIG_FRAC);
 758              		.loc 1 197 0
 759 00cc E36C     		ldr	r3, [r4, #76]
 760 00ce 5943     		muls	r1, r3, r1
 198:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.y = INT_MULT_RSHIFT(gh_ref.max_speed_int, gh_ref.s_route_ref, INT32_TRIG_FRAC);
 761              		.loc 1 198 0
 762 00d0 5343     		muls	r3, r2, r3
 197:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.x = INT_MULT_RSHIFT(gh_ref.max_speed_int, gh_ref.c_route_ref, INT32_TRIG_FRAC);
 763              		.loc 1 197 0
 764 00d2 8913     		asrs	r1, r1, #14
 198:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.y = INT_MULT_RSHIFT(gh_ref.max_speed_int, gh_ref.s_route_ref, INT32_TRIG_FRAC);
 765              		.loc 1 198 0
 766 00d4 9B13     		asrs	r3, r3, #14
 197:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.x = INT_MULT_RSHIFT(gh_ref.max_speed_int, gh_ref.c_route_ref, INT32_TRIG_FRAC);
 767              		.loc 1 197 0
 768 00d6 E163     		str	r1, [r4, #60]
 198:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.y = INT_MULT_RSHIFT(gh_ref.max_speed_int, gh_ref.s_route_ref, INT32_TRIG_FRAC);
 769              		.loc 1 198 0
 770 00d8 2364     		str	r3, [r4, #64]
 771              	.L67:
 201:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_LSHIFT(gh_ref.max_vel, gh_ref.max_vel, (GH_SPEED_REF_FRAC - GH_MAX_SPEED_REF_FRAC));
 772              		.loc 1 201 0
 773 00da E36B     		ldr	r3, [r4, #60]
 774 00dc 9B02     		lsls	r3, r3, #10
 775 00de E363     		str	r3, [r4, #60]
 776 00e0 236C     		ldr	r3, [r4, #64]
 777 00e2 9B02     		lsls	r3, r3, #10
 778 00e4 2364     		str	r3, [r4, #64]
 779              	.LBE13:
 780              	.LBE12:
 143:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_saturate_ref_accel();
 781              		.loc 1 143 0
 782 00e6 FFF7FEFF 		bl	gh_saturate_ref_accel
 783              	.LVL39:
 144:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_saturate_ref_speed();
 784              		.loc 1 144 0
 785 00ea FFF7FEFF 		bl	gh_saturate_ref_speed
 786              	.LVL40:
 145:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 787              		.loc 1 145 0
 788 00ee 05B0     		add	sp, sp, #20
 789              		@ sp needed
 790 00f0 F0BD     		pop	{r4, r5, r6, r7, pc}
 791              	.LVL41:
 792              	.L69:
 793 00f2 00BFAFF3 		.align	3
 793      0080
 794              	.L68:
 795 00f8 39B4C876 		.word	1992864825
 796 00fc BE9FE63F 		.word	1072078782
 797 0100 00000000 		.word	.LANCHOR0
 798              		.cfi_endproc
 799              	.LFE15:
 801 0104 AFF30080 		.section	.text.gh_update_ref_from_speed_sp,"ax",%progbits
 802              		.align	1
 803              		.global	gh_update_ref_from_speed_sp
 804              		.thumb
 805              		.thumb_func
 807              	gh_update_ref_from_speed_sp:
 808              	.LFB16:
 149:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 809              		.loc 1 149 0
 810              		.cfi_startproc
 811              		@ args = 0, pretend = 0, frame = 16
 812              		@ frame_needed = 0, uses_anonymous_args = 0
 813 0000 7FB5     		push	{r0, r1, r2, r3, r4, r5, r6, lr}
 814              		.cfi_def_cfa_offset 32
 815              		.cfi_offset 0, -32
 816              		.cfi_offset 1, -28
 817              		.cfi_offset 2, -24
 818              		.cfi_offset 3, -20
 819              		.cfi_offset 4, -16
 820              		.cfi_offset 5, -12
 821              		.cfi_offset 6, -8
 822              		.cfi_offset 14, -4
 151:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 823              		.loc 1 151 0
 824 0002 374C     		ldr	r4, .L75+8
 825 0004 D4E90423 		ldrd	r2, [r4, #16]
 149:firmwares/rotorcraft/guidance/guidance_h_ref.c **** {
 826              		.loc 1 149 0
 827 0008 8DE80300 		stmia	sp, {r0, r1}
 151:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 828              		.loc 1 151 0
 829 000c A068     		ldr	r0, [r4, #8]
 830 000e E168     		ldr	r1, [r4, #12]
 152:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.speed, gh_ref.accel);
 831              		.loc 1 152 0
 832 0010 2668     		ldr	r6, [r4]
 151:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.pos, gh_ref.speed);
 833              		.loc 1 151 0
 834 0012 1218     		adds	r2, r2, r0
 835 0014 43EBE073 		adc	r3, r3, r0, asr #31
 836 0018 C4E90423 		strd	r2, [r4, #16]
 837 001c D4E90623 		ldrd	r2, [r4, #24]
 838 0020 5218     		adds	r2, r2, r1
 839 0022 43EBE173 		adc	r3, r3, r1, asr #31
 840 0026 C4E90623 		strd	r2, [r4, #24]
 152:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.speed, gh_ref.accel);
 841              		.loc 1 152 0
 842 002a 6368     		ldr	r3, [r4, #4]
 843 002c 1944     		add	r1, r1, r3
 156:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed_err, speed_sp, (INT32_SPEED_FRAC - GH_SPEED_REF_FRAC));
 844              		.loc 1 156 0
 845 002e 9DE80C00 		ldmia	sp, {r2, r3}
 152:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.speed, gh_ref.accel);
 846              		.loc 1 152 0
 847 0032 0644     		add	r6, r6, r0
 161:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(gh_ref.accel, speed_err, -gh_ref.inv_tau);
 848              		.loc 1 161 0
 849 0034 A06B     		ldr	r0, [r4, #56]
 152:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_ref.speed, gh_ref.accel);
 850              		.loc 1 152 0
 851 0036 A660     		str	r6, [r4, #8]
 852 0038 E160     		str	r1, [r4, #12]
 157:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_DIFF(speed_err, gh_ref.speed, speed_err);
 853              		.loc 1 157 0
 854 003a A6EBA206 		sub	r6, r6, r2, asr #2
 855 003e A1EBA301 		sub	r1, r1, r3, asr #2
 159:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed_err, speed_err, (GH_SPEED_REF_FRAC - GH_ACCEL_REF_FRAC));
 856              		.loc 1 159 0
 857 0042 7612     		asrs	r6, r6, #9
 858 0044 4912     		asrs	r1, r1, #9
 161:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(gh_ref.accel, speed_err, -gh_ref.inv_tau);
 859              		.loc 1 161 0
 860 0046 4042     		negs	r0, r0
 159:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed_err, speed_err, (GH_SPEED_REF_FRAC - GH_ACCEL_REF_FRAC));
 861              		.loc 1 159 0
 862 0048 0296     		str	r6, [sp, #8]
 863 004a 0391     		str	r1, [sp, #12]
 161:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(gh_ref.accel, speed_err, -gh_ref.inv_tau);
 864              		.loc 1 161 0
 865 004c 4643     		muls	r6, r0, r6
 866 004e 4143     		muls	r1, r0, r1
 162:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(gh_ref.accel, gh_ref.accel, GH_REF_INV_TAU_FRAC);
 867              		.loc 1 162 0
 868 0050 3614     		asrs	r6, r6, #16
 869 0052 0914     		asrs	r1, r1, #16
 870 0054 2660     		str	r6, [r4]
 871 0056 6160     		str	r1, [r4, #4]
 872              	.LVL42:
 873              	.LBB18:
 874              	.LBB19:
 224:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (ref_vector->x == 0 && ref_vector->y == 0) {
 875              		.loc 1 224 0
 876 0058 6AB9     		cbnz	r2, .L71
 877 005a 63B9     		cbnz	r3, .L71
 225:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.x = gh_ref.max_vel.y = gh_ref.max_speed_int * 0.707;
 878              		.loc 1 225 0
 879 005c E06C     		ldr	r0, [r4, #76]
 880 005e FFF7FEFF 		bl	__aeabi_i2d
 881              	.LVL43:
 882 0062 1DA3     		adr	r3, .L75
 883 0064 D3E90023 		ldrd	r2, [r3]
 884 0068 FFF7FEFF 		bl	__aeabi_dmul
 885              	.LVL44:
 886 006c FFF7FEFF 		bl	__aeabi_d2iz
 887              	.LVL45:
 888 0070 2064     		str	r0, [r4, #64]
 889 0072 E063     		str	r0, [r4, #60]
 890 0074 0BE0     		b	.L72
 891              	.L71:
 227:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_compute_route_ref(ref_vector);
 892              		.loc 1 227 0
 893 0076 6846     		mov	r0, sp
 894              	.LVL46:
 895 0078 FFF7FEFF 		bl	gh_compute_route_ref
 896              	.LVL47:
 229:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.x = INT_MULT_RSHIFT(gh_ref.max_speed_int, gh_ref.c_route_ref, INT32_TRIG_FRAC);
 897              		.loc 1 229 0
 898 007c E36C     		ldr	r3, [r4, #76]
 899 007e A26D     		ldr	r2, [r4, #88]
 900 0080 5A43     		muls	r2, r3, r2
 901 0082 9213     		asrs	r2, r2, #14
 902 0084 E263     		str	r2, [r4, #60]
 230:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_vel.y = INT_MULT_RSHIFT(gh_ref.max_speed_int, gh_ref.s_route_ref, INT32_TRIG_FRAC);
 903              		.loc 1 230 0
 904 0086 626D     		ldr	r2, [r4, #84]
 905 0088 5343     		muls	r3, r2, r3
 906 008a 9B13     		asrs	r3, r3, #14
 907 008c 2364     		str	r3, [r4, #64]
 908              	.L72:
 233:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_LSHIFT(gh_ref.max_vel, gh_ref.max_vel, (GH_SPEED_REF_FRAC - GH_MAX_SPEED_REF_FRAC));
 909              		.loc 1 233 0
 910 008e E26B     		ldr	r2, [r4, #60]
 911 0090 134B     		ldr	r3, .L75+8
 912 0092 9202     		lsls	r2, r2, #10
 913 0094 E263     		str	r2, [r4, #60]
 914 0096 226C     		ldr	r2, [r4, #64]
 915 0098 9202     		lsls	r2, r2, #10
 916 009a 2264     		str	r2, [r4, #64]
 917              	.LVL48:
 918              	.LBE19:
 919              	.LBE18:
 920              	.LBB20:
 921              	.LBB21:
 209:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (ref_vector->x == 0 && ref_vector->y == 0) {
 922              		.loc 1 209 0
 923 009c 029A     		ldr	r2, [sp, #8]
 924 009e 32B9     		cbnz	r2, .L73
 925 00a0 039A     		ldr	r2, [sp, #12]
 926 00a2 22B9     		cbnz	r2, .L73
 210:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.x = gh_ref.max_accel.y = gh_max_accel * 0.707;
 927              		.loc 1 210 0
 928 00a4 40F2F242 		movw	r2, #1266
 929 00a8 9A64     		str	r2, [r3, #72]
 930 00aa 5A64     		str	r2, [r3, #68]
 931 00ac 0CE0     		b	.L74
 932              	.L73:
 212:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_compute_route_ref(ref_vector);
 933              		.loc 1 212 0
 934 00ae 02A8     		add	r0, sp, #8
 935              	.LVL49:
 936 00b0 FFF7FEFF 		bl	gh_compute_route_ref
 937              	.LVL50:
 214:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.x = INT_MULT_RSHIFT(gh_max_accel, gh_ref.c_route_ref, INT32_TRIG_FRAC);
 938              		.loc 1 214 0
 939 00b4 A26D     		ldr	r2, [r4, #88]
 940 00b6 4FF4E063 		mov	r3, #1792
 941 00ba 5A43     		muls	r2, r3, r2
 942 00bc 9213     		asrs	r2, r2, #14
 943 00be 6264     		str	r2, [r4, #68]
 215:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_ref.max_accel.y = INT_MULT_RSHIFT(gh_max_accel, gh_ref.s_route_ref, INT32_TRIG_FRAC);
 944              		.loc 1 215 0
 945 00c0 626D     		ldr	r2, [r4, #84]
 946 00c2 5343     		muls	r3, r2, r3
 947 00c4 9B13     		asrs	r3, r3, #14
 948 00c6 A364     		str	r3, [r4, #72]
 949              	.L74:
 950              	.LBE21:
 951              	.LBE20:
 168:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_saturate_ref_accel();
 952              		.loc 1 168 0
 953 00c8 FFF7FEFF 		bl	gh_saturate_ref_accel
 954              	.LVL51:
 169:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_saturate_ref_speed();
 955              		.loc 1 169 0
 956 00cc FFF7FEFF 		bl	gh_saturate_ref_speed
 957              	.LVL52:
 170:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 958              		.loc 1 170 0
 959 00d0 04B0     		add	sp, sp, #16
 960              	.LVL53:
 961              		@ sp needed
 962 00d2 70BD     		pop	{r4, r5, r6, pc}
 963              	.LVL54:
 964              	.L76:
 965 00d4 AFF30080 		.align	3
 966              	.L75:
 967 00d8 39B4C876 		.word	1992864825
 968 00dc BE9FE63F 		.word	1072078782
 969 00e0 00000000 		.word	.LANCHOR0
 970              		.cfi_endproc
 971              	.LFE16:
 973              		.global	gh_ref
 974 00e4 AFF30080 		.section	.bss.gh_ref,"aw",%nobits
 975              		.align	3
 976              		.set	.LANCHOR0,. + 0
 979              	gh_ref:
 980 0000 00000000 		.space	96
 980      00000000 
 980      00000000 
 980      00000000 
 980      00000000 
 981              		.text
 982              	.Letext0:
 983              		.file 2 "/home/lsk/gcc-arm-none-eabi-4_8-2014q3/arm-none-eabi/include/machine/_default_types.h"
 984              		.file 3 "/home/lsk/gcc-arm-none-eabi-4_8-2014q3/arm-none-eabi/include/stdint.h"
 985              		.file 4 "./math/pprz_algebra_int.h"
 986              		.file 5 "./firmwares/rotorcraft/guidance/guidance_h_ref.h"
 987              		.file 6 "/home/lsk/gcc-arm-none-eabi-4_8-2014q3/arm-none-eabi/include/math.h"
 988              		.file 7 "./math/pprz_trig_int.h"
DEFINED SYMBOLS
                            *ABS*:00000000 guidance_h_ref.c
     /tmp/cc5M0Lww.s:20     .text.gh_saturate_ref_accel:00000000 $t
     /tmp/cc5M0Lww.s:24     .text.gh_saturate_ref_accel:00000000 gh_saturate_ref_accel
     /tmp/cc5M0Lww.s:64     .text.gh_saturate_ref_accel:00000028 $d
     /tmp/cc5M0Lww.s:69     .text.gh_saturate_ref_speed:00000000 $t
     /tmp/cc5M0Lww.s:73     .text.gh_saturate_ref_speed:00000000 gh_saturate_ref_speed
     /tmp/cc5M0Lww.s:144    .text.gh_saturate_ref_speed:00000050 $d
     /tmp/cc5M0Lww.s:149    .text.gh_compute_route_ref:00000000 $t
     /tmp/cc5M0Lww.s:153    .text.gh_compute_route_ref:00000000 gh_compute_route_ref
     /tmp/cc5M0Lww.s:215    .text.gh_compute_route_ref:00000060 $d
     /tmp/cc5M0Lww.s:221    .text.gh_ref_init:00000000 $t
     /tmp/cc5M0Lww.s:226    .text.gh_ref_init:00000000 gh_ref_init
     /tmp/cc5M0Lww.s:270    .text.gh_ref_init:00000030 $d
     /tmp/cc5M0Lww.s:279    .text.gh_set_max_speed:00000000 $t
     /tmp/cc5M0Lww.s:284    .text.gh_set_max_speed:00000000 gh_set_max_speed
     /tmp/cc5M0Lww.s:318    .text.gh_set_max_speed:00000038 $d
     /tmp/cc5M0Lww.s:329    .text.gh_set_tau:00000000 $t
     /tmp/cc5M0Lww.s:334    .text.gh_set_tau:00000000 gh_set_tau
     /tmp/cc5M0Lww.s:394    .text.gh_set_tau:00000058 $d
     /tmp/cc5M0Lww.s:402    .text.gh_set_omega:00000000 $t
     /tmp/cc5M0Lww.s:407    .text.gh_set_omega:00000000 gh_set_omega
     /tmp/cc5M0Lww.s:461    .text.gh_set_omega:00000068 $d
     /tmp/cc5M0Lww.s:469    .text.gh_set_zeta:00000000 $t
     /tmp/cc5M0Lww.s:474    .text.gh_set_zeta:00000000 gh_set_zeta
     /tmp/cc5M0Lww.s:520    .text.gh_set_zeta:00000054 $d
     /tmp/cc5M0Lww.s:528    .text.gh_set_ref:00000000 $t
     /tmp/cc5M0Lww.s:533    .text.gh_set_ref:00000000 gh_set_ref
     /tmp/cc5M0Lww.s:600    .text.gh_set_ref:0000004c $d
     /tmp/cc5M0Lww.s:606    .text.gh_update_ref_from_pos_sp:00000000 $t
     /tmp/cc5M0Lww.s:611    .text.gh_update_ref_from_pos_sp:00000000 gh_update_ref_from_pos_sp
     /tmp/cc5M0Lww.s:795    .text.gh_update_ref_from_pos_sp:000000f8 $d
     /tmp/cc5M0Lww.s:802    .text.gh_update_ref_from_speed_sp:00000000 $t
     /tmp/cc5M0Lww.s:807    .text.gh_update_ref_from_speed_sp:00000000 gh_update_ref_from_speed_sp
     /tmp/cc5M0Lww.s:967    .text.gh_update_ref_from_speed_sp:000000d8 $d
     /tmp/cc5M0Lww.s:979    .bss.gh_ref:00000000 gh_ref
     /tmp/cc5M0Lww.s:975    .bss.gh_ref:00000000 $d
                     .debug_frame:00000010 $d
     /tmp/cc5M0Lww.s:801    .text.gh_update_ref_from_pos_sp:00000104 $t
     /tmp/cc5M0Lww.s:974    .text.gh_update_ref_from_speed_sp:000000e4 $t
                           .group:00000000 wm4.0.61e172dafa1e7adfbd840ee8b103061f
                           .group:00000000 wm4.features.h.22.6a4ca7cd053637cc1d0db6c16f39b2d7
                           .group:00000000 wm4._default_types.h.6.9e4229723f5523536bc8f574589d6a99
                           .group:00000000 wm4.stdint.h.20.796e373797e732130a803d4c0338fa1b
                           .group:00000000 wm4.stddef.h.263.49e44f5ee9cdd8820580fc4aa239e32a
                           .group:00000000 wm4.inttypes.h.24.4db40689d622c4d3b547b5801303bdae
                           .group:00000000 wm4.float.h.29.1cf88a0527b6b1225d49fbee2b32acb7
                           .group:00000000 wm4.newlib.h.8.fec018e441fee7bfa1923812ad010f97
                           .group:00000000 wm4.config.h.212.4163ef2871a828c674038d036b081cfd
                           .group:00000000 wm4._ansi.h.23.2147fde150631f5584b9dc29b914d1b8
                           .group:00000000 wm4.stddef.h.39.2b75ea897b59bf67f50e970d678806e4
                           .group:00000000 wm4.lock.h.2.9bc98482741e5e2a9450b12934a684ea
                           .group:00000000 wm4._types.h.54.d3d34a3b7f3cc230cd159baf022b4b08
                           .group:00000000 wm4.stddef.h.158.61317cdbfb4026324507d123a50b0fd6
                           .group:00000000 wm4.reent.h.17.8bd9e4098e0428508c282cad794fae43
                           .group:00000000 wm4.cdefs.h.56.a2d04de9d47039852021e66fca39bb58
                           .group:00000000 wm4.string.h.15.dab3980bf35408a4c507182805e2de3a
                           .group:00000000 wm4.stddef.h.158.a7efb00f6cbc6f43213b50e183c9830c
                           .group:00000000 wm4.string.h.126.6ff3aa59129e7f66b2c273baf353e066
                           .group:00000000 wm4.stdbool.h.29.1c9ee6859ce8145f7838a4f2549ccec2
                           .group:00000000 wm4.math.h.35.6ddd393aa87bd6f6206738d11f2687bd
                           .group:00000000 wm4.message_pragmas.h.2.a703592919ab94db061a475289156c21
                           .group:00000000 wm4.std.h.37.c94f17957e155d4dda789b7ad0549a32
                           .group:00000000 wm4.pprz_algebra.h.47.d249264ea6bacf2198e290d461cf6dbe
                           .group:00000000 wm4.pprz_trig_int.h.28.b756be608c9d9f3092a41321446e5fa2
                           .group:00000000 wm4.stdlib.h.13.4ed386f5c1a80d71e72172885d946ef2
                           .group:00000000 wm4.alloca.h.8.dfc0c703c47ec3e69746825b17d9e66d
                           .group:00000000 wm4.stdlib.h.53.1a82a3cc35cb0a04319c41bcf41d2a02
                           .group:00000000 wm4.pprz_algebra_int.h.68.04ac162ae1e1d94f716d0bb402062624
                           .group:00000000 wm4.airframe.h.5.1b65f22e2c90217dfc42bdae27fe483a
                           .group:00000000 wm4.krooz_sd.h.2.013366a614baabbe44cc2bbd3205e3d1
                           .group:00000000 wm4.actuators_pwm_arch.h.41.fa66469024778df593e0e3d83e4a3c37
                           .group:00000000 wm4.airframe.h.14.f46e30d413878b482f16a5abf2127a4b
                           .group:00000000 wm4.guidance_h_ref.h.54.c95d003feb98dc47429b6860fec54f81

UNDEFINED SYMBOLS
atan2f
pprz_itrig_sin
pprz_itrig_cos
__aeabi_f2d
__aeabi_ddiv
__aeabi_dmul
__aeabi_d2iz
__aeabi_i2d

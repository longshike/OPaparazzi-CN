/* This file has been generated from /home/dino/paparazzi/conf/airframes/My_apogee.xml */
/* Please DO NOT EDIT */

#ifndef AIRFRAME_H
#define AIRFRAME_H

#define AIRFRAME_NAME "MY_apogee"
#define AC_ID 1
#define MD5SUM ((uint8_t*)"\260\361\257\354\366\116\125\353\252\104\204\373\375\141\353\240")

#define SERVOS_DEFAULT_NB 5
#include "subsystems/actuators/actuators_default.h"

#define SERVO_MOTOR 0
#define SERVO_MOTOR_NEUTRAL 1000
#define SERVO_MOTOR_TRAVEL_UP 0.104166666667
#define SERVO_MOTOR_TRAVEL_UP_NUM 5
#define SERVO_MOTOR_TRAVEL_UP_DEN 48
#define SERVO_MOTOR_TRAVEL_DOWN 0
#define SERVO_MOTOR_TRAVEL_DOWN_NUM 0
#define SERVO_MOTOR_TRAVEL_DOWN_DEN 1
#define SERVO_MOTOR_MAX 2000
#define SERVO_MOTOR_MIN 1000

#define SERVO_AILEVON_LEFT 1
#define SERVO_AILEVON_LEFT_NEUTRAL 1500
#define SERVO_AILEVON_LEFT_TRAVEL_UP 0.0520833333333
#define SERVO_AILEVON_LEFT_TRAVEL_UP_NUM 5
#define SERVO_AILEVON_LEFT_TRAVEL_UP_DEN 96
#define SERVO_AILEVON_LEFT_TRAVEL_DOWN 0.0520833333333
#define SERVO_AILEVON_LEFT_TRAVEL_DOWN_NUM 5
#define SERVO_AILEVON_LEFT_TRAVEL_DOWN_DEN 96
#define SERVO_AILEVON_LEFT_MAX 2000
#define SERVO_AILEVON_LEFT_MIN 1000

#define SERVO_AILEVON_RIGHT 2
#define SERVO_AILEVON_RIGHT_NEUTRAL 1500
#define SERVO_AILEVON_RIGHT_TRAVEL_UP 0.0520833333333
#define SERVO_AILEVON_RIGHT_TRAVEL_UP_NUM 5
#define SERVO_AILEVON_RIGHT_TRAVEL_UP_DEN 96
#define SERVO_AILEVON_RIGHT_TRAVEL_DOWN 0.0520833333333
#define SERVO_AILEVON_RIGHT_TRAVEL_DOWN_NUM 5
#define SERVO_AILEVON_RIGHT_TRAVEL_DOWN_DEN 96
#define SERVO_AILEVON_RIGHT_MAX 2000
#define SERVO_AILEVON_RIGHT_MIN 1000

#define SERVO_ELEVATOR 3
#define SERVO_ELEVATOR_NEUTRAL 1500
#define SERVO_ELEVATOR_TRAVEL_UP 0.0520833333333
#define SERVO_ELEVATOR_TRAVEL_UP_NUM 5
#define SERVO_ELEVATOR_TRAVEL_UP_DEN 96
#define SERVO_ELEVATOR_TRAVEL_DOWN 0.0520833333333
#define SERVO_ELEVATOR_TRAVEL_DOWN_NUM 5
#define SERVO_ELEVATOR_TRAVEL_DOWN_DEN 96
#define SERVO_ELEVATOR_MAX 2000
#define SERVO_ELEVATOR_MIN 1000

#define SERVO_RUDDER 4
#define SERVO_RUDDER_NEUTRAL 1500
#define SERVO_RUDDER_TRAVEL_UP 0.0520833333333
#define SERVO_RUDDER_TRAVEL_UP_NUM 5
#define SERVO_RUDDER_TRAVEL_UP_DEN 96
#define SERVO_RUDDER_TRAVEL_DOWN 0.0520833333333
#define SERVO_RUDDER_TRAVEL_DOWN_NUM 5
#define SERVO_RUDDER_TRAVEL_DOWN_DEN 96
#define SERVO_RUDDER_MAX 2000
#define SERVO_RUDDER_MIN 1000


#define COMMAND_THROTTLE 0
#define COMMAND_ROLL 1
#define COMMAND_PITCH 2
#define COMMAND_YAW 3
#define COMMANDS_NB 4
#define COMMANDS_FAILSAFE {0,0,0,0}


#define SetCommandsFromRC(_commands_array, _rc_array) { \
  _commands_array[COMMAND_THROTTLE] = _rc_array[RADIO_THROTTLE];\
  _commands_array[COMMAND_ROLL] = _rc_array[RADIO_ROLL];\
  _commands_array[COMMAND_PITCH] = _rc_array[RADIO_PITCH];\
  _commands_array[COMMAND_YAW] = _rc_array[RADIO_YAW];\
}

#define SERVO_AILEVON_RIGHT_IDX 2
#define Set_AILEVON_RIGHT_Servo(_v) { \
  actuators[SERVO_AILEVON_RIGHT_IDX] = Chop(_v, SERVO_AILEVON_RIGHT_MIN, SERVO_AILEVON_RIGHT_MAX); \
  ActuatorDefaultSet(SERVO_AILEVON_RIGHT, actuators[SERVO_AILEVON_RIGHT_IDX]); \
}

#define SERVO_RUDDER_IDX 4
#define Set_RUDDER_Servo(_v) { \
  actuators[SERVO_RUDDER_IDX] = Chop(_v, SERVO_RUDDER_MIN, SERVO_RUDDER_MAX); \
  ActuatorDefaultSet(SERVO_RUDDER, actuators[SERVO_RUDDER_IDX]); \
}

#define SERVO_ELEVATOR_IDX 3
#define Set_ELEVATOR_Servo(_v) { \
  actuators[SERVO_ELEVATOR_IDX] = Chop(_v, SERVO_ELEVATOR_MIN, SERVO_ELEVATOR_MAX); \
  ActuatorDefaultSet(SERVO_ELEVATOR, actuators[SERVO_ELEVATOR_IDX]); \
}

#define SERVO_AILEVON_LEFT_IDX 1
#define Set_AILEVON_LEFT_Servo(_v) { \
  actuators[SERVO_AILEVON_LEFT_IDX] = Chop(_v, SERVO_AILEVON_LEFT_MIN, SERVO_AILEVON_LEFT_MAX); \
  ActuatorDefaultSet(SERVO_AILEVON_LEFT, actuators[SERVO_AILEVON_LEFT_IDX]); \
}

#define SERVO_MOTOR_IDX 0
#define Set_MOTOR_Servo(_v) { \
  actuators[SERVO_MOTOR_IDX] = Chop(_v, SERVO_MOTOR_MIN, SERVO_MOTOR_MAX); \
  ActuatorDefaultSet(SERVO_MOTOR, actuators[SERVO_MOTOR_IDX]); \
}

#define ACTUATORS_NB 5

#define AllActuatorsInit() { \
  ActuatorsDefaultInit();\
}

#define AllActuatorsCommit() { \
  ActuatorsDefaultCommit();\
}

#define SetActuatorsFromCommands(values, AP_MODE) { \
  int32_t servo_value;\
  int32_t command_value;\
\
  command_value = values[COMMAND_THROTTLE]; \
  command_value *= command_value>0 ? SERVO_MOTOR_TRAVEL_UP_NUM : SERVO_MOTOR_TRAVEL_DOWN_NUM; \
  command_value /= command_value>0 ? SERVO_MOTOR_TRAVEL_UP_DEN : SERVO_MOTOR_TRAVEL_DOWN_DEN; \
  servo_value = SERVO_MOTOR_NEUTRAL + command_value; \
  Set_MOTOR_Servo(servo_value); \
\
  command_value = values[COMMAND_ROLL]; \
  command_value *= command_value>0 ? SERVO_AILEVON_LEFT_TRAVEL_UP_NUM : SERVO_AILEVON_LEFT_TRAVEL_DOWN_NUM; \
  command_value /= command_value>0 ? SERVO_AILEVON_LEFT_TRAVEL_UP_DEN : SERVO_AILEVON_LEFT_TRAVEL_DOWN_DEN; \
  servo_value = SERVO_AILEVON_LEFT_NEUTRAL + command_value; \
  Set_AILEVON_LEFT_Servo(servo_value); \
\
  command_value = values[COMMAND_ROLL]; \
  command_value *= command_value>0 ? SERVO_AILEVON_RIGHT_TRAVEL_UP_NUM : SERVO_AILEVON_RIGHT_TRAVEL_DOWN_NUM; \
  command_value /= command_value>0 ? SERVO_AILEVON_RIGHT_TRAVEL_UP_DEN : SERVO_AILEVON_RIGHT_TRAVEL_DOWN_DEN; \
  servo_value = SERVO_AILEVON_RIGHT_NEUTRAL + command_value; \
  Set_AILEVON_RIGHT_Servo(servo_value); \
\
  command_value = values[COMMAND_PITCH]; \
  command_value *= command_value>0 ? SERVO_ELEVATOR_TRAVEL_UP_NUM : SERVO_ELEVATOR_TRAVEL_DOWN_NUM; \
  command_value /= command_value>0 ? SERVO_ELEVATOR_TRAVEL_UP_DEN : SERVO_ELEVATOR_TRAVEL_DOWN_DEN; \
  servo_value = SERVO_ELEVATOR_NEUTRAL + command_value; \
  Set_ELEVATOR_Servo(servo_value); \
\
  command_value = values[COMMAND_YAW]; \
  command_value *= command_value>0 ? SERVO_RUDDER_TRAVEL_UP_NUM : SERVO_RUDDER_TRAVEL_DOWN_NUM; \
  command_value /= command_value>0 ? SERVO_RUDDER_TRAVEL_UP_DEN : SERVO_RUDDER_TRAVEL_DOWN_DEN; \
  servo_value = SERVO_RUDDER_NEUTRAL + command_value; \
  Set_RUDDER_Servo(servo_value); \
\
  AllActuatorsCommit(); \
}

#define SECTION_AUTO1 1
#define AUTO1_MAX_ROLL 0.85
#define AUTO1_MAX_PITCH 0.6

#define SECTION_IMU 1
#define IMU_ACCEL_X_NEUTRAL -68
#define IMU_ACCEL_Y_NEUTRAL -1
#define IMU_ACCEL_Z_NEUTRAL -64
#define IMU_ACCEL_X_SENS 2.46053275899
#define IMU_ACCEL_X_SENS_NUM 50249
#define IMU_ACCEL_X_SENS_DEN 20422
#define IMU_ACCEL_Y_SENS 2.45567151099
#define IMU_ACCEL_Y_SENS_NUM 25178
#define IMU_ACCEL_Y_SENS_DEN 10253
#define IMU_ACCEL_Z_SENS 2.44223710019
#define IMU_ACCEL_Z_SENS_NUM 11310
#define IMU_ACCEL_Z_SENS_DEN 4631
#define IMU_GYRO_P_NEUTRAL 0
#define IMU_GYRO_Q_NEUTRAL 0
#define IMU_GYRO_R_NEUTRAL 0
#define IMU_GYRO_P_SENS 2.17953
#define IMU_GYRO_P_SENS_NUM 18271
#define IMU_GYRO_P_SENS_DEN 8383
#define IMU_GYRO_Q_SENS 2.17953
#define IMU_GYRO_Q_SENS_NUM 18271
#define IMU_GYRO_Q_SENS_DEN 8383
#define IMU_GYRO_R_SENS 2.17953
#define IMU_GYRO_R_SENS_NUM 18271
#define IMU_GYRO_R_SENS_DEN 8383
#define IMU_MAG_X_SIGN 1
#define IMU_MAG_Y_SIGN -1
#define IMU_MAG_Z_SIGN 1
#define IMU_MAG_X_NEUTRAL 0
#define IMU_MAG_Y_NEUTRAL 0
#define IMU_MAG_Z_NEUTRAL 0
#define IMU_MAG_X_SENS 3.275275943
#define IMU_MAG_X_SENS_NUM 14837
#define IMU_MAG_X_SENS_DEN 4530
#define IMU_MAG_Y_SENS 3.35260531591
#define IMU_MAG_Y_SENS_NUM 4697
#define IMU_MAG_Y_SENS_DEN 1401
#define IMU_MAG_Z_SENS 3.64252765358
#define IMU_MAG_Z_SENS_NUM 7897
#define IMU_MAG_Z_SENS_DEN 2168
#define IMU_BODY_TO_IMU_PHI RadOfDeg(180.0)
#define IMU_BODY_TO_IMU_THETA RadOfDeg(0.0)
#define IMU_BODY_TO_IMU_PSI RadOfDeg(0.0)

#define SECTION_AHRS 1
#define AHRS_H_X 0.541917101
#define AHRS_H_Y -0.072885923
#define AHRS_H_Z 0.837265687

#define SECTION_INS 1
#define INS_ROLL_NEUTRAL_DEFAULT 0.
#define INS_PITCH_NEUTRAL_DEFAULT 0.

#define SECTION_BAT 1
#define MILLIAMP_AT_FULL_THROTTLE 2000
#define MilliAmpereOfAdc(_adc) (_adc-158)*16.5698
#define CATASTROPHIC_BAT_LEVEL 9.3
#define CRITIC_BAT_LEVEL 9.6
#define LOW_BAT_LEVEL 9.7
#define MAX_BAT_LEVEL 12.4

#define SECTION_MISC 1
#define NOMINAL_AIRSPEED 15.
#define CARROT 3.
#define KILL_MODE_DISTANCE (1.5*MAX_DIST_FROM_HOME)
#define CONTROL_FREQUENCY 60
#define DEFAULT_CIRCLE_RADIUS 70.
#define UNLOCKED_HOME_MODE TRUE

#define SECTION_VERTICAL CONTROL 1
#define V_CTL_POWER_CTL_BAT_NOMINAL 11.1
#define V_CTL_ALTITUDE_PGAIN 0.18
#define V_CTL_ALTITUDE_MAX_CLIMB 5.
#define V_CTL_AUTO_THROTTLE_NOMINAL_CRUISE_THROTTLE 0.45
#define V_CTL_AUTO_THROTTLE_MIN_CRUISE_THROTTLE 0.25
#define V_CTL_AUTO_THROTTLE_MAX_CRUISE_THROTTLE 0.85
#define V_CTL_AUTO_PITCH_MAX_PITCH RadOfDeg(20.)
#define V_CTL_AUTO_PITCH_MIN_PITCH -RadOfDeg(20.)
#define V_CTL_AUTO_THROTTLE_CLIMB_THROTTLE_INCREMENT 0.15
#define V_CTL_AUTO_THROTTLE_PGAIN 0.01
#define V_CTL_AUTO_THROTTLE_IGAIN 0.1
#define V_CTL_AUTO_THROTTLE_PITCH_OF_VZ_PGAIN 0.05
#define V_CTL_THROTTLE_SLEW_LIMITER 2

#define SECTION_HORIZONTAL CONTROL 1
#define H_CTL_COURSE_PGAIN 1.0
#define H_CTL_COURSE_DGAIN 0.3
#define H_CTL_ROLL_MAX_SETPOINT 0.6108652375
#define H_CTL_PITCH_MAX_SETPOINT 0.523598775
#define H_CTL_PITCH_MIN_SETPOINT -0.523598775
#define H_CTL_PITCH_PGAIN 12000.
#define H_CTL_PITCH_DGAIN 1.5
#define H_CTL_ELEVATOR_OF_ROLL 1250
#define H_CTL_ROLL_SLEW 0.1
#define H_CTL_ROLL_ATTITUDE_GAIN 7500
#define H_CTL_ROLL_RATE_GAIN 1500

#define SECTION_AGGRESSIVE 1
#define AGR_BLEND_START 20
#define AGR_BLEND_END 10
#define AGR_CLIMB_THROTTLE 1.00
#define AGR_CLIMB_PITCH 0.3
#define AGR_DESCENT_THROTTLE 0.1
#define AGR_DESCENT_PITCH -0.25
#define AGR_CLIMB_NAV_RATIO 0.8
#define AGR_DESCENT_NAV_RATIO 1.0

#define SECTION_NAV 1
#define NAV_PITCH 0.
#define NAV_GLIDE_PITCH_TRIM 0

#define SECTION_FAILSAFE 1
#define FAILSAFE_DELAY_WITHOUT_GPS 2
#define FAILSAFE_DEFAULT_THROTTLE 0.3
#define FAILSAFE_DEFAULT_ROLL 0.3
#define FAILSAFE_DEFAULT_PITCH 0.5
#define FAILSAFE_HOME_RADIUS 100

#define SECTION_GLS_APPROACH 1
#define APP_ANGLE 0.104719755
#define APP_INTERCEPT_RATE 0.624
#define APP_DISTANCE_AF_SD 20
#define APP_TARGET_SPEED 14

#define SECTION_SIMU 1
#define JSBSIM_MODEL "Malolo1"
#define JSBSIM_LAUNCHSPEED 15.0
#define JSBSIM_IR_ROLL_NEUTRAL RadOfDeg(0.)
#define JSBSIM_IR_PITCH_NEUTRAL RadOfDeg(0.)


#endif // AIRFRAME_H
